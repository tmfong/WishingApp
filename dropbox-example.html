<!DOCTYPE html>
<html>
  <head>
    <title>Ember Dropbox.DataStore Adapter Example</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
  </head>
  <body>
    <script type="text/x-handlebars">
      {{outlet}}
    </script>
    <script type="text/x-handlebars" data-template-name="tasks">
      <h2>Tasks</h2>
      <ul>
        {{#each}}
        <li>
          {{name}}
          <button {{action "deleteTask" this bubbles=false}}>x</button>
        </li>
        {{/each}}
      </ul>
      {{input placeholder="new task" value=newTask action="createTask"}}
    </script>

    <a href="https://www.dropbox.com/developers/browse_datastores/516178">Browse datastores</a>

    <script src="https://code.jquery.com/jquery.js"></script>
    <script src="https://www.dropbox.com/static/api/dropbox-datastores-1.0-latest.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/handlebars.js/1.1.2/handlebars.min.js"></script>
    <script src="ember-1.3.0-beta.4.js"></script>
    <script src="ember-data-1.0.0-beta.4.js"></script>
    <script src="ember-dropbox-datastore-adapter.js"></script>
    <script type="text/javascript">
      /* App */
      App = Ember.Application.create();
      App.ApplicationAdapter = DropboxDataStoreAdapter("73ds1pucgfhztmh", App);
      /* Models */
      App.Task = DS.Model.extend({
        name: DS.attr()
      });
      /* Routes */
      App.Router.map(function() {
        this.resource('tasks', {path: '/tasks'});
      });
      App.IndexRoute = Ember.Route.extend({
        redirect: function() {
          this.transitionTo('tasks');
        }
      });
      App.TasksRoute = Ember.Route.extend({
        model: function() {
          return this.get('store').findAll('task');
        },
      });
      /* controlelrs */
      App.TasksController = Ember.ArrayController.extend({
        actions: {
          createTask: function() {
            var task = this.get("newTask").trim();
            var record = this.get('store').createRecord('task', {
              name: task
            });
            record.save();
            this.set("newTask", "");
          },
          deleteTask: function(task) {
            task.deleteRecord();
            task.save();
          }
        }
      });
    </script>
  </body>
</html>
